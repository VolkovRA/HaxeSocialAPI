{
    "version": "2.0.0",
    "tasks": [

        // Дефолтная задача для быстрых, локальных тестов:
        {
            "label": "test",
            "dependsOrder": "sequence",
            "group": {
                "kind": "build",
                "isDefault": true
            },
            "dependsOn": [
                // ТЕСТЫ СЕРВЕРА:
                //"compile",
                //"compile ",
                //"compile",
                //"nodejs run vk",
                //"nodejs run ok",
                //"nodejs run fb",

                // ТЕСТЫ КЛИЕНТА:
                "compile",
                "image build",
                "compose up",
            ],
            "problemMatcher": [
                "$haxe-absolute",
                "$haxe",
                "$haxe-error",
                "$haxe-trace"
            ],
            "detail": "Задача по умолчанию",
        },



        ////////////////
        //   DOCKER   //
        ////////////////

        // Запуск докера локально:
        {
            "label": "compose up",
            "type": "shell",
            "command": "docker-compose",
            "args": [
                "-f", "docker-compose.yml",
                "-p", "social_api",
                "up",
            ],
            "presentation": {
                "clear": true
            },
            "problemMatcher": [],
        },

        // Сборка образа для локальных тестов:
        {
            "label": "image build",
            "type": "shell",
            "command": "docker",
            "args": [
                "build",
                ".",
                "-t",
                "rvolkov/social_api:latest"
            ],
            "presentation": {
                "clear": true
            },
            "problemMatcher": [],
        },



        /////////////////
        //   COMPILE   //
        /////////////////

        // Компиляция кода:
        {
            "label": "compile",
            "type": "shell",
            "command": "haxe",
            "args": [
                "build.hxml",
            ],
            "problemMatcher": [
                "$haxe-absolute",
                "$haxe",
                "$haxe-error",
                "$haxe-trace"
            ],
            "group": "none",
            "presentation": {
                "clear": true
            }
        },



        ////////////////
        //   NODEJS   //
        ////////////////

        // Запуск серверного VK:
        {
            "label": "nodejs run vk",
            "type": "shell",
            "command": "node",
            "args": [
                "bin/server/index_vk.js",
            ],
            "group": "none",
            "problemMatcher": [
                "$node-sass"
            ],
            "presentation": {
                "clear": true
            }
        },

        // Запуск серверного OK:
        {
            "label": "nodejs run ok",
            "type": "shell",
            "command": "node",
            "args": [
                "bin/server/index_ok.js",
            ],
            "group": "none",
            "problemMatcher": [
                "$node-sass"
            ],
            "presentation": {
                "clear": true
            }
        },

        // Запуск серверного FB:
        {
            "label": "nodejs run fb",
            "type": "shell",
            "command": "node",
            "args": [
                "bin/server/index_fb.js",
            ],
            "group": "none",
            "problemMatcher": [
                "$node-sass"
            ],
            "presentation": {
                "clear": true
            }
        },
    ]
}